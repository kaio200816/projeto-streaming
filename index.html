<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jogo F√°cil EXTREMO</title>
<style>
:root{--bg:#0f1724;--card:#0b1220;--accent:#10b981;}
html,body{height:100%;margin:0;font-family:Inter,sans-serif;color:#e6eef8;background:#050d1a;display:flex;align-items:center;justify-content:center;overflow:hidden}
.wrapper{width:960px;max-width:95%;background:#0b1220;border-radius:12px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,0.6);position:relative;}
header{margin-bottom:12px}
h1{font-size:22px;margin:0}
p.lead{margin:4px 0 0;color:#94a3b8;font-size:13px}
.hud{display:flex;gap:15px;margin-top:10px;}
.pill{background:#1e293b;padding:6px 12px;border-radius:20px;font-size:14px;font-weight:600;}
.difficulty-meter{width:100%;height:8px;background:#1e293b;border-radius:4px;margin-top:10px;overflow:hidden;}
.difficulty-progress{height:100%;background:linear-gradient(90deg, #10b981, #f59e0b, #ef4444);width:0%;transition:width 0.3s ease;}
.game{position:relative;min-height:480px;overflow:hidden; width: 100%;border:2px solid #1e293b;border-radius:8px;}
.big-btn{position:absolute;padding:18px 34px;border-radius:999px;background:green;color:#042018;font-weight:700;cursor:pointer;user-select:none;box-shadow:0 6px 18px rgba(16,185,129,0.25);transition:all 0.3s ease; display:flex;align-items:center;justify-content:center;border:3px solid transparent;font-size:16px;z-index:10;}
.big-btn:hover{transform:scale(1.05);}
.big-btn.danger{border-color:#ef4444;animation:pulse 0.5s infinite alternate;}
.stage{display:none;}
.stage.active{display:block;}
#chapolin{position:absolute;width:100px;height:100px;display:none;z-index:999;transform-origin:center center;}
.particle{position:absolute;width:20px;height:20px;background:var(--accent);border-radius:50%;pointer-events:none;}
.volume-indicator{position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.7);padding:5px 10px;border-radius:15px;font-size:12px;display:flex;align-items:center;gap:5px;}
.volume-bar{width:60px;height:4px;background:#374151;border-radius:2px;overflow:hidden;}
.volume-level{height:100%;background:#10b981;width:0%;transition:width 0.3s ease;}
.win-screen{text-align:center;padding:40px;}
.win-screen h2{font-size:32px;margin-bottom:20px;background:linear-gradient(45deg, #10b981, #3b82f6);background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
#playAgain{padding:15px 30px;font-size:18px;margin-top:20px;}

@keyframes pulse {
  from { box-shadow: 0 0 10px rgba(239, 68, 68, 0.5); }
  to { box-shadow: 0 0 20px rgba(239, 68, 68, 0.8); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

@keyframes megaShake {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  10% { transform: translate(-10px, -5px) rotate(-2deg); }
  20% { transform: translate(10px, 5px) rotate(2deg); }
  30% { transform: translate(-8px, 3px) rotate(-1deg); }
  40% { transform: translate(8px, -3px) rotate(1deg); }
  50% { transform: translate(-6px, -2px) rotate(-0.5deg); }
  60% { transform: translate(6px, 2px) rotate(0.5deg); }
  70% { transform: translate(-4px, 1px) rotate(-0.2deg); }
  80% { transform: translate(4px, -1px) rotate(0.2deg); }
  90% { transform: translate(-2px, 0px) rotate(-0.1deg); }
}

@keyframes chapolinSpin {
  0% { transform: rotate(0deg) scale(1); }
  25% { transform: rotate(90deg) scale(1.1); }
  50% { transform: rotate(180deg) scale(1.2); }
  75% { transform: rotate(270deg) scale(1.3); }
  100% { transform: rotate(360deg) scale(1.4); }
}

@keyframes chapolinExplode {
  0% { 
    transform: rotate(0deg) scale(1); 
    filter: brightness(1) hue-rotate(0deg);
  }
  25% { 
    transform: rotate(90deg) scale(1.5); 
    filter: brightness(1.5) hue-rotate(90deg);
  }
  50% { 
    transform: rotate(180deg) scale(2); 
    filter: brightness(2) hue-rotate(180deg);
  }
  75% { 
    transform: rotate(270deg) scale(2.5); 
    filter: brightness(2.5) hue-rotate(270deg);
  }
  100% { 
    transform: rotate(360deg) scale(3); 
    filter: brightness(3) hue-rotate(360deg);
    opacity: 0;
  }
}

@keyframes screenFlash {
  0%, 100% { background-color: transparent; }
  10% { background-color: #ff0000; }
  20% { background-color: #ffff00; }
  30% { background-color: #ff0000; }
  40% { background-color: #ffffff; }
  50% { background-color: #ff0000; }
  60% { background-color: #ffff00; }
  70% { background-color: #ff0000; }
  80% { background-color: #ffffff; }
  90% { background-color: #ff0000; }
}

@keyframes particleExplode {
  0% { 
    transform: translate(0, 0) scale(1) rotate(0deg);
    opacity: 1;
  }
  50% { 
    transform: translate(var(--dx), var(--dy)) scale(1.5) rotate(180deg);
    opacity: 0.8;
  }
  100% { 
    transform: translate(calc(var(--dx) * 2), calc(var(--dy) * 2)) scale(0.5) rotate(360deg);
    opacity: 0;
  }
}

@keyframes shockwave {
  0% { 
    transform: scale(0);
    opacity: 1;
  }
  100% { 
    transform: scale(10);
    opacity: 0;
  }
}

@keyframes textReveal {
  0% { 
    transform: scale(0) rotate(180deg);
    opacity: 0;
  }
  50% { 
    transform: scale(1.2) rotate(0deg);
    opacity: 1;
  }
  100% { 
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

.shake { animation: shake 0.1s ease-in-out infinite; }
.megaShake { animation: megaShake 0.5s ease-in-out infinite; }
.chapolinSpin { animation: chapolinSpin 0.3s ease-in-out infinite; }
.chapolinExplode { animation: chapolinExplode 2s ease-out forwards; }
.screenFlash { animation: screenFlash 0.1s ease-in-out infinite; }
.particleExplode { animation: particleExplode 2s ease-out forwards; }
.shockwave { animation: shockwave 1s ease-out forwards; }
.textReveal { animation: textReveal 1s ease-out forwards; }
</style>
</head>
<body>
<audio id="bgMusic" src="https://files.catbox.moe/jh5pww.mp3" loop></audio>
<audio id="explosionSound" preload="auto"></audio>
<audio id="boomSound" preload="auto"></audio>

<div class="wrapper">
  <header>
    <h1>üéÆ Jogo F√°cil (Mas Nem Tanto!)</h1>
    <p class="lead">Pegue o bot√£o verde antes que o Chapolin ou o tempo acabem!</p>
    
    <div class="hud">
      <div class="pill">üéØ Tentativas: <span id="attempts">0</span>/30</div>
      <div class="pill">‚ö° Dificuldade: <span id="difficulty">F√°cil</span></div>
      <div class="pill">üèÜ Stage: <span id="stage">1</span></div>
    </div>
    
    <div class="difficulty-meter">
      <div id="difficultyProgress" class="difficulty-progress"></div>
    </div>
  </header>
  
  <div class="volume-indicator">
    <span>üîä</span>
    <div class="volume-bar">
      <div id="volumeLevel" class="volume-level"></div>
    </div>
    <span id="volumeText">0%</span>
  </div>
  
  <main class="game">
    <div id="stage1" class="stage active">
      <div id="btn1" class="big-btn">üéØ VENCER üéØ</div>
      <img id="chapolin" src="https://files.catbox.moe/tq0ox6.png">
    </div>
    
    <div id="winScreen" class="stage win-screen">
      <h2>üéâ VOC√ä VENCEU! üéâ</h2>
      <p>Voc√™ conseguiu pegar o bot√£o verde com <span id="finalAttempts">0</span> tentativas!</p>
      <button id="playAgain" class="big-btn">üîÑ Jogar de novo</button>
    </div>
  </main>
</div>

<script>
// ===========================================
// SISTEMA ANTI-DEVTOOL - PROTE√á√ÉO M√ÅXIMA
// ===========================================

// Vari√°veis de controle anti-devtool
let devToolsOpen = false;
let devToolsAttempts = 0;
let isDebugging = false;
let lastWindowSize = { width: window.innerWidth, height: window.innerHeight };

// Fun√ß√£o para detectar DevTools aberto
function detectDevTools() {
    const threshold = 160;
    const widthThreshold = window.outerWidth - window.innerWidth > threshold;
    const heightThreshold = window.outerHeight - window.innerHeight > threshold;
    
    if (widthThreshold || heightThreshold) {
        if (!devToolsOpen) {
            devToolsOpen = true;
            devToolsAttempts++;
            handleDevToolsDetection();
        }
    } else {
        devToolsOpen = false;
    }
}

// Fun√ß√£o para lidar com detec√ß√£o do DevTools
function handleDevToolsDetection() {
    // Aumenta a dificuldade drasticamente
    hoverCount += 10;
    attemptsEl.textContent = hoverCount;
    
    // Efeito visual de puni√ß√£o
    document.body.style.background = '#ff0000';
    document.body.style.animation = 'shake 0.1s ease-in-out infinite';
    
    // Mostra aviso
    alert(`üö´ DEVTOOLS DETECTADO! üö´\nTentativa ${devToolsAttempts}/3\nO jogo ficou mais dif√≠cil!`);
    
    // Reset visual ap√≥s 2 segundos
    setTimeout(() => {
        document.body.style.background = '#050d1a';
        document.body.style.animation = 'none';
    }, 2000);
    
    // Game over ap√≥s 3 tentativas
    if (devToolsAttempts >= 3) {
        alert('üíÄ GAME OVER! üíÄ\nMuitas tentativas de burlar o sistema!');
        location.href = 'about:blank';
    }
}

// Detec√ß√£o de redimensionamento suspeito
function detectSuspiciousResize() {
    const currentWidth = window.innerWidth;
    const currentHeight = window.innerHeight;
    
    // Detecta mudan√ßas bruscas de tamanho (poss√≠vel DevTools)
    if (Math.abs(currentWidth - lastWindowSize.width) > 200 || 
        Math.abs(currentHeight - lastWindowSize.height) > 200) {
        handleDevToolsDetection();
    }
    
    lastWindowSize = { width: currentWidth, height: currentHeight };
}

// Prote√ß√£o contra inspe√ß√£o de elementos
function protectElements() {
    // Remove event listeners se algu√©m tentar inspecionar
    const originalAddEventListener = Element.prototype.addEventListener;
    Element.prototype.addEventListener = function(type, listener, options) {
        if (type === 'contextmenu' || type === 'keydown') {
            return;
        }
        return originalAddEventListener.call(this, type, listener, options);
    };
}

// Prote√ß√£o contra console (vers√£o mais suave)
function protectConsole() {
    // Apenas intercepta tentativas de debug, mas n√£o quebra o console completamente
    const originalLog = console.log;
    console.log = function(...args) {
        // Detecta tentativas de debug
        if (args.some(arg => typeof arg === 'string' && 
            (arg.includes('debug') || arg.includes('devtools') || arg.includes('inspect')))) {
            handleDevToolsDetection();
        }
        return originalLog.apply(this, args);
    };
}

// Prote√ß√£o contra debugger (vers√£o mais suave)
function protectDebugger() {
    // Detecta uso de debugger apenas ocasionalmente
    setInterval(() => {
        if (devToolsOpen) {
            const start = performance.now();
            debugger;
            const end = performance.now();
            
            if (end - start > 100) {
                handleDevToolsDetection();
            }
        }
    }, 3000); // Verifica a cada 3 segundos em vez de 1
}

// Prote√ß√£o contra atalhos de teclado
function protectKeyboard() {
    document.addEventListener('keydown', (e) => {
        // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+S
        if (e.key === 'F12' || 
            (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||
            (e.ctrlKey && (e.key === 'u' || e.key === 's'))) {
            e.preventDefault();
            handleDevToolsDetection();
            return false;
        }
    });
}

// Prote√ß√£o contra clique direito
function protectContextMenu() {
    document.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        handleDevToolsDetection();
        return false;
    });
}

// Prote√ß√£o contra sele√ß√£o de texto
function protectSelection() {
    document.addEventListener('selectstart', (e) => {
        e.preventDefault();
        return false;
    });
}

// Ofusca√ß√£o de vari√°veis importantes
function obfuscateVariables() {
    // Renomeia vari√°veis cr√≠ticas
    window['_0x1a2b'] = hoverCount;
    window['_0x3c4d'] = gameStarted;
    window['_0x5e6f'] = devToolsOpen;
}

// Inicializa√ß√£o das prote√ß√µes
function initAntiDevTools() {
    protectConsole();
    protectElements();
    protectKeyboard();
    protectContextMenu();
    protectSelection();
    obfuscateVariables();
    
    // Monitoramento cont√≠nuo
    setInterval(detectDevTools, 500);
    setInterval(detectSuspiciousResize, 1000);
    setInterval(protectDebugger, 1000);
    
    // Monitora mudan√ßas no DOM
    const observer = new MutationObserver(() => {
        if (devToolsOpen) {
            handleDevToolsDetection();
        }
    });
    observer.observe(document.body, { childList: true, subtree: true });
}

// Prote√ß√£o adicional contra manipula√ß√£o de c√≥digo
function protectCodeIntegrity() {
    // Protege fun√ß√µes cr√≠ticas
    const originalEval = window.eval;
    window.eval = function(code) {
        handleDevToolsDetection();
        return originalEval.call(this, code);
    };
    
    // Protege Function constructor
    const originalFunction = window.Function;
    window.Function = function(...args) {
        handleDevToolsDetection();
        return originalFunction.apply(this, args);
    };
    
    // Protege setTimeout/setInterval
    const originalSetTimeout = window.setTimeout;
    window.setTimeout = function(fn, delay) {
        if (typeof fn === 'string') {
            handleDevToolsDetection();
        }
        return originalSetTimeout.call(this, fn, delay);
    };
}

// Prote√ß√£o contra modifica√ß√£o de propriedades (vers√£o mais suave)
function protectProperties() {
    // Apenas monitora tentativas de modifica√ß√£o via window
    const originalDefineProperty = Object.defineProperty;
    Object.defineProperty = function(obj, prop, descriptor) {
        if (obj === window && (prop === 'hoverCount' || prop === 'gameStarted')) {
            handleDevToolsDetection();
        }
        return originalDefineProperty.call(this, obj, prop, descriptor);
    };
}

// Prote√ß√£o contra iframe injection
function protectIframe() {
    if (window !== window.top) {
        handleDevToolsDetection();
    }
}

// Prote√ß√£o contra source maps
function protectSourceMaps() {
    // Remove source maps se existirem
    const scripts = document.querySelectorAll('script');
    scripts.forEach(script => {
        if (script.src && script.src.includes('sourcemap')) {
            script.remove();
        }
    });
}

// Prote√ß√£o contra extens√µes do navegador
function protectExtensions() {
    // Detecta extens√µes suspeitas
    const suspiciousProps = ['chrome', 'browser', 'extension'];
    suspiciousProps.forEach(prop => {
        if (window[prop]) {
            handleDevToolsDetection();
        }
    });
}

// Prote√ß√£o contra modifica√ß√£o de CSS (vers√£o mais suave)
function protectCSS() {
    // Apenas adiciona prote√ß√£o b√°sica de sele√ß√£o
    const style = document.createElement('style');
    style.textContent = `
        body { 
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    `;
    document.head.appendChild(style);
}

// Inicializa√ß√£o das prote√ß√µes (vers√£o simplificada)
function initAntiDevTools() {
    protectKeyboard();
    protectContextMenu();
    protectSelection();
    protectCSS();
    
    // Monitoramento cont√≠nuo (menos agressivo)
    setInterval(detectDevTools, 1000);
    setInterval(detectSuspiciousResize, 2000);
    setInterval(protectDebugger, 5000);
}

// Sistema de detec√ß√£o de tempo (anti-burla)
function initTimeProtection() {
    let startTime = Date.now();
    let lastCheck = startTime;
    
    setInterval(() => {
        const currentTime = Date.now();
        const expectedTime = lastCheck + 1000; // Espera 1 segundo entre checks
        const timeDiff = Math.abs(currentTime - expectedTime);
        
        // Se a diferen√ßa for muito grande, pode ser manipula√ß√£o de tempo
        if (timeDiff > 2000) {
            handleDevToolsDetection();
        }
        
        lastCheck = currentTime;
    }, 1000);
}

// Prote√ß√£o contra manipula√ß√£o de performance
function protectPerformance() {
    // Apenas monitora, n√£o substitui completamente
    let lastNow = performance.now();
    
    setInterval(() => {
        const current = performance.now();
        const diff = current - lastNow;
        
        // Detecta manipula√ß√£o do performance.now apenas se muito suspeito
        if (diff < -1000 || diff > 50000) {
            handleDevToolsDetection();
        }
        
        lastNow = current;
    }, 2000);
}

// Prote√ß√£o contra modifica√ß√£o de Date (vers√£o mais suave)
function protectDate() {
    // Apenas monitora mudan√ßas suspeitas, n√£o substitui Date
    let lastDate = new Date();
    
    setInterval(() => {
        const current = new Date();
        const diff = current - lastDate;
        
        // Detecta manipula√ß√£o de data apenas se muito suspeito
        if (Math.abs(diff) > 10000) {
            handleDevToolsDetection();
        }
        
        lastDate = current;
    }, 2000);
}

// Prote√ß√£o contra modifica√ß√£o de Math.random (vers√£o mais suave)
function protectRandom() {
    // Apenas monitora uso excessivo, n√£o substitui Math.random
    let callCount = 0;
    const originalRandom = Math.random;
    
    setInterval(() => {
        callCount = 0; // Reset contador a cada intervalo
    }, 5000);
    
    // Intercepta apenas chamadas suspeitas
    const originalRandomCall = Math.random;
    Math.random = function() {
        callCount++;
        
        // Detecta uso excessivo de random apenas se muito suspeito
        if (callCount > 5000) {
            handleDevToolsDetection();
        }
        
        return originalRandomCall();
    };
}

// Prote√ß√£o contra modifica√ß√£o de localStorage/sessionStorage (vers√£o mais suave)
function protectStorage() {
    // Apenas monitora tentativas de debug via storage
    const originalSetItem = Storage.prototype.setItem;
    
    Storage.prototype.setItem = function(key, value) {
        if (typeof key === 'string' && (key.includes('devtools') || key.includes('debug'))) {
            handleDevToolsDetection();
        }
        return originalSetItem.call(this, key, value);
    };
}

// Inicia as prote√ß√µes imediatamente (vers√£o simplificada)
initAntiDevTools();

// ===========================================
// C√ìDIGO DO JOGO (PROTEGIDO)
// ===========================================

const gameContainer = document.querySelector('.game');
const btn1 = document.getElementById('btn1');
const chapolin = document.getElementById('chapolin');
const attemptsEl = document.getElementById('attempts');
const difficultyEl = document.getElementById('difficulty');
const stageEl = document.getElementById('stage');
const difficultyProgress = document.getElementById('difficultyProgress');
const volumeLevel = document.getElementById('volumeLevel');
const volumeText = document.getElementById('volumeText');
const bgMusic = document.getElementById('bgMusic');
const explosionSound = document.getElementById('explosionSound');
const boomSound = document.getElementById('boomSound');
const finalAttempts = document.getElementById('finalAttempts');

let hoverCount = 0;
let gameStarted = false;
let lastMouseX = 0;
let lastMouseY = 0;

// Inicializa o √°udio
bgMusic.volume = 0.1;

// Sistema de √°udio √©pico para explos√£o
function createExplosionAudio() {
    let audioContext = null;
    
    // Fun√ß√£o para inicializar AudioContext
    function initAudioContext() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }
        if (audioContext.state === 'suspended') {
            audioContext.resume();
        }
    }
    
    // Fun√ß√£o para criar tom com frequ√™ncia espec√≠fica
    function createTone(frequency, duration, volume = 0.1) {
        try {
            initAudioContext();
            if (!audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = 'sawtooth';
            
            // Envelope de volume crescente
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + duration * 0.1);
            gainNode.gain.linearRampToValueAtTime(volume * 0.8, audioContext.currentTime + duration * 0.8);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        } catch (e) {
            console.log('Erro no √°udio:', e);
        }
    }
    
    // Fun√ß√£o para criar ru√≠do branco (explos√£o)
    function createWhiteNoise(duration, volume = 0.1) {
        try {
            initAudioContext();
            if (!audioContext) return;
            
            const bufferSize = audioContext.sampleRate * duration;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const output = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                output[i] = (Math.random() * 2 - 1) * volume;
            }
            
            const whiteNoise = audioContext.createBufferSource();
            const gainNode = audioContext.createGain();
            
            whiteNoise.buffer = buffer;
            whiteNoise.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Envelope crescente
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + duration * 0.2);
            gainNode.gain.linearRampToValueAtTime(volume * 0.3, audioContext.currentTime + duration * 0.8);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + duration);
            
            whiteNoise.start(audioContext.currentTime);
            whiteNoise.stop(audioContext.currentTime + duration);
        } catch (e) {
            console.log('Erro no ru√≠do:', e);
        }
    }
    
    // Fun√ß√£o para criar BOOM final
    function createBoom() {
        try {
            initAudioContext();
            if (!audioContext) return;
            
            // M√∫ltiplas frequ√™ncias para efeito de BOOM
            createTone(60, 0.5, 0.3);  // Grave
            createTone(120, 0.4, 0.2); // M√©dio
            createTone(240, 0.3, 0.1); // Agudo
            createWhiteNoise(0.8, 0.4); // Ru√≠do de explos√£o
        } catch (e) {
            console.log('Erro no BOOM:', e);
        }
    }
    
    return { createTone, createWhiteNoise, createBoom };
}

// Inicializa o sistema de √°udio
const explosionAudio = createExplosionAudio();

// Fun√ß√£o para garantir que a m√∫sica continue tocando
function ensureMusicPlaying() {
    if (gameStarted && bgMusic.paused) {
        bgMusic.play().catch(e => {
            console.log('Erro ao retomar m√∫sica:', e);
        });
    }
}

// Verifica periodicamente se a m√∫sica est√° tocando
setInterval(ensureMusicPlaying, 1000);

// Fun√ß√£o para iniciar o jogo (e a m√∫sica)
function startGame() {
    if (!gameStarted) {
        gameStarted = true;
        // Tenta tocar a m√∫sica
        bgMusic.play().catch(e => {
            console.log('Autoplay bloqueado, clique para iniciar');
        });
        
        // Garante que a m√∫sica est√° tocando
        if (bgMusic.paused) {
            bgMusic.play().catch(e => {
                console.log('Erro ao tocar m√∫sica:', e);
            });
        }
    }
}

// Atualiza volume baseado na dificuldade
function updateVolume() {
    let volume = 0.1;
    
    if (hoverCount >= 5) volume = 0.4;
    if (hoverCount >= 10) volume = 0.6;
    if (hoverCount >= 15) volume = 1.0;
    if (hoverCount >= 20) volume = 1.2;
    if (hoverCount >= 25) volume = 1.5;
    if (hoverCount >= 28) volume = 2.0; // Volume estourado!
    
    // Aplica o volume com um efeito suave
    bgMusic.volume = Math.min(volume, 1.0); // Limita a 1.0 para navegadores seguros
    volumeLevel.style.width = (volume * 100) + '%';
    volumeText.textContent = Math.min(Math.round(volume * 100), 100) + '%';
    
    // Efeito visual quando o volume est√° alto
    if (volume >= 0.8) {
        volumeLevel.style.background = '#ef4444';
        document.body.style.animation = volume >= 1.0 ? 'shake 0.1s ease-in-out infinite' : 'none';
    } else {
        volumeLevel.style.background = '#10b981';
        document.body.style.animation = 'none';
    }
}

// Atualiza a dificuldade visual
function updateDifficulty() {
    const progress = (hoverCount / 30) * 100;
    difficultyProgress.style.width = progress + '%';
    
    if (hoverCount < 5) {
        difficultyEl.textContent = "F√°cil";
        difficultyEl.style.color = "#10b981";
    } else if (hoverCount < 10) {
        difficultyEl.textContent = "M√©dio";
        difficultyEl.style.color = "#f59e0b";
    } else if (hoverCount < 20) {
        difficultyEl.textContent = "Dif√≠cil";
        difficultyEl.style.color = "#fb923c";
        btn1.classList.add('danger');
    } else {
        difficultyEl.textContent = "EXTREMO!";
        difficultyEl.style.color = "#ef4444";
    }
}

// Define posi√ß√£o inicial no centro do container do jogo
function centerButton() {
    btn1.style.left = (gameContainer.clientWidth/2 - btn1.offsetWidth/2) + 'px';
    btn1.style.top = (gameContainer.clientHeight/2 - btn1.offsetHeight/2) + 'px';
}

// Aguarda o carregamento para posicionar corretamente
window.addEventListener('load', centerButton);
window.addEventListener('resize', centerButton);

// Limita posi√ß√£o dentro do container do jogo com margem de seguran√ßa
function getRandomPosition(){
    const margin = 30; // Margem de seguran√ßa para n√£o ficar muito perto das bordas
    const maxX = gameContainer.clientWidth - btn1.offsetWidth - margin*2;
    const maxY = gameContainer.clientHeight - btn1.offsetHeight - margin*2;
    let x = Math.random() * maxX + margin;
    let y = Math.random() * maxY + margin;
    x = Math.max(margin, Math.min(x, maxX + margin));
    y = Math.max(margin, Math.min(y, maxY + margin));
    return {x,y};
}

// Posiciona o bot√£o longe do cursor
function getPositionAwayFromCursor(){
    const margin = 50;
    const maxX = gameContainer.clientWidth - btn1.offsetWidth - margin*2;
    const maxY = gameContainer.clientHeight - btn1.offsetHeight - margin*2;
    
    // Calcula a dire√ß√£o oposta ao cursor
    const btnRect = btn1.getBoundingClientRect();
    const gameRect = gameContainer.getBoundingClientRect();
    const btnCenterX = btnRect.left + btnRect.width/2;
    const btnCenterY = btnRect.top + btnRect.height/2;
    
    const deltaX = lastMouseX - btnCenterX;
    const deltaY = lastMouseY - btnCenterY;
    
    // Normaliza a dire√ß√£o
    const distance = Math.sqrt(deltaX*deltaX + deltaY*deltaY);
    const dirX = deltaX / distance;
    const dirY = deltaY / distance;
    
    // Move na dire√ß√£o oposta
    let newX = btnRect.left - gameRect.left - dirX * 150;
    let newY = btnRect.top - gameRect.top - dirY * 150;
    
    // Garante que est√° dentro dos limites
    newX = Math.max(margin, Math.min(newX, maxX + margin));
    newY = Math.max(margin, Math.min(newY, maxY + margin));
    
    return {x: newX, y: newY};
}

function updateButtonColor(){
  if(hoverCount < 10) {
      btn1.style.background='green';
      btn1.style.color='#042018';
  } else if(hoverCount < 15) {
      btn1.style.background='yellow';
      btn1.style.color='#422006';
  } else if(hoverCount < 20) {
      btn1.style.background='orange';
      btn1.style.color='#451a03';
  } else {
      btn1.style.background='red';
      btn1.style.color='white';
  }
}

// Reduz o tamanho do bot√£o conforme a dificuldade aumenta
function updateButtonSize() {
    const baseSize = 18; // Tamanho base da fonte
    const paddingReduction = Math.min(hoverCount * 0.7, 10); // Redu√ß√£o progressiva
    const fontSize = Math.max(baseSize - hoverCount * 0.3, 12); // Fonte menor
    
    btn1.style.padding = `${18 - paddingReduction}px ${34 - paddingReduction * 1.5}px`;
    btn1.style.fontSize = `${fontSize}px`;
}

// Chapolin d√° tapa no bot√£o (vers√£o √©pica)
function chapolinTap(){
  const btnRect = btn1.getBoundingClientRect();
  const gameRect = gameContainer.getBoundingClientRect();
  
  chapolin.style.left = (btnRect.left - gameRect.left - 30) + "px";
  chapolin.style.top = (btnRect.top - gameRect.top - 30) + "px";
  chapolin.style.display = "block";
  chapolin.style.transition = "all 0.3s ease";
  chapolin.style.transform = "rotate(360deg) scale(1.2)";
  chapolin.style.filter = "brightness(1.5) drop-shadow(0 0 10px #ff0000)";
  chapolin.classList.add('chapolinSpin');

  // Efeito de tela piscando
  document.body.classList.add('megaShake');
  
  // Som de tapa √©pico
  bgMusic.playbackRate = 1.8;
  setTimeout(() => bgMusic.playbackRate = 1.0, 300);

  const pos = getRandomPosition();
  btn1.style.left = pos.x + "px";
  btn1.style.top = pos.y + "px";

  setTimeout(()=>{
    chapolin.style.display='none';
    chapolin.style.transform='rotate(0deg) scale(1)';
    chapolin.style.filter = 'none';
    chapolin.classList.remove('chapolinSpin');
    document.body.classList.remove('megaShake');
  },800);
}

// EXPLOS√ÉO √âPICA FINAL - DIGNA DE OSCAR! üí•üé¨
function explodeButton(){
  const btnRect = btn1.getBoundingClientRect();
  const gameRect = gameContainer.getBoundingClientRect();
  const centerX = btnRect.left - gameRect.left + btn1.offsetWidth/2;
  const centerY = btnRect.top - gameRect.top + btn1.offsetHeight/2;
  
  // === FASE 1: PREPARA√á√ÉO √âPICA ===
  document.body.classList.add('megaShake');
  document.body.classList.add('screenFlash');
  
  // Chapolin aparece e come√ßa a girar loucamente
  chapolin.style.left = (centerX - 50) + "px";
  chapolin.style.top = (centerY - 50) + "px";
  chapolin.style.display = "block";
  chapolin.style.zIndex = "9999";
  chapolin.classList.add('chapolinExplode');
  
  // Som √©pico de explos√£o - SISTEMA CRESCENTE
  bgMusic.playbackRate = 2.0;
  bgMusic.volume = 1.0;
  
  // SISTEMA DE √ÅUDIO √âPICO CRESCENTE
  // Efeito de explos√£o crescente usando a m√∫sica de fundo
  let explosionStep = 0;
  const explosionInterval = setInterval(() => {
    explosionStep++;
    
    // Aumenta progressivamente a velocidade e volume
    bgMusic.playbackRate = 2.0 + (explosionStep * 0.1);
    bgMusic.volume = Math.min(1.0, 0.5 + (explosionStep * 0.05));
    
    // Tenta usar √°udio sint√©tico se dispon√≠vel
    if (explosionAudio) {
      explosionAudio.createTone(80 + (explosionStep * 20), 0.2, 0.1 + (explosionStep * 0.02));
    }
    
    // Para ap√≥s 7 passos (crescimento completo)
    if (explosionStep >= 7) {
      clearInterval(explosionInterval);
    }
  }, 100);
  
  // === FASE 2: ONDA DE CHOQUE ===
  setTimeout(() => {
    // Cria onda de choque
    const shockwave = document.createElement('div');
    shockwave.style.position = 'absolute';
    shockwave.style.left = centerX + 'px';
    shockwave.style.top = centerY + 'px';
    shockwave.style.width = '20px';
    shockwave.style.height = '20px';
    shockwave.style.background = 'radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,0,0,0.6) 50%, transparent 100%)';
    shockwave.style.borderRadius = '50%';
    shockwave.style.transform = 'translate(-50%, -50%)';
    shockwave.style.zIndex = '9998';
    shockwave.classList.add('shockwave');
    gameContainer.appendChild(shockwave);
    
    // Remove onda de choque ap√≥s anima√ß√£o
    setTimeout(() => shockwave.remove(), 1000);
  }, 500);
  
  // === FASE 3: EXPLOS√ÉO DE PART√çCULAS √âPICA ===
  setTimeout(() => {
    const particles = [];
    const particleCount = 50; // Mais part√≠culas para efeito √©pico
    
    for(let i = 0; i < particleCount; i++){
      const p = document.createElement('div');
      p.classList.add('particle');
      p.style.position = 'absolute';
      p.style.left = centerX + 'px';
      p.style.top = centerY + 'px';
      p.style.width = '15px';
      p.style.height = '15px';
      p.style.borderRadius = '50%';
      p.style.pointerEvents = 'none';
      p.style.zIndex = '9997';
      
      // Cores variadas para efeito √©pico
      const colors = ['#ff0000', '#ffff00', '#ff8800', '#ff0088', '#8800ff', '#00ffff', '#ffffff'];
      p.style.background = colors[Math.floor(Math.random() * colors.length)];
      p.style.boxShadow = '0 0 20px ' + colors[Math.floor(Math.random() * colors.length)];
      
      gameContainer.appendChild(p);
      particles.push(p);
      
      // C√°lculo de dire√ß√£o √©pica
      const angle = (i / particleCount) * Math.PI * 2;
      const distance = 200 + Math.random() * 300;
      const dx = Math.cos(angle) * distance;
      const dy = Math.sin(angle) * distance;
      const rot = Math.random() * 720;
      
      // Aplica vari√°veis CSS para anima√ß√£o
      p.style.setProperty('--dx', dx + 'px');
      p.style.setProperty('--dy', dy + 'px');
      
      // Anima√ß√£o √©pica da part√≠cula
      p.classList.add('particleExplode');
    }
    
    // === FASE 4: EFEITOS DE TELA √âPICOS + BOOM FINAL ===
    // Flash de tela branca + BOOM √âPICO
    setTimeout(() => {
      // BOOM FINAL √âPICO!
      if (explosionAudio) {
        explosionAudio.createBoom();
      }
      
      // Efeito de √°udio m√°ximo
      bgMusic.playbackRate = 3.0;
      bgMusic.volume = 1.0;
      
      // Flash de tela branca
      const flash = document.createElement('div');
      flash.style.position = 'fixed';
      flash.style.top = '0';
      flash.style.left = '0';
      flash.style.width = '100vw';
      flash.style.height = '100vh';
      flash.style.background = 'white';
      flash.style.zIndex = '10000';
      flash.style.pointerEvents = 'none';
      document.body.appendChild(flash);
      
      // Efeito de "tela quebrada" ap√≥s o flash
      setTimeout(() => {
        flash.style.background = 'linear-gradient(45deg, #ff0000, #ffff00, #ff0000)';
        flash.style.animation = 'screenFlash 0.1s ease-in-out infinite';
      }, 50);
      
      setTimeout(() => {
        flash.remove();
        // Reset do √°udio
        bgMusic.playbackRate = 1.0;
        bgMusic.volume = 0.1;
        // Garante que a m√∫sica continue tocando
        if (bgMusic.paused) {
          bgMusic.play().catch(e => console.log('Erro ao retomar m√∫sica ap√≥s explos√£o:', e));
        }
      }, 200);
    }, 1000);
    
    // === FASE 5: TEXTO √âPICO DE GAME OVER ===
    setTimeout(() => {
      const gameOverText = document.createElement('div');
      gameOverText.innerHTML = `
        <div style="
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 4rem;
          font-weight: bold;
          color: #ff0000;
          text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000, 0 0 60px #ff0000;
          z-index: 10001;
          text-align: center;
          font-family: 'Arial Black', sans-serif;
        ">
          üí• CHAPOLIN DESTRUIU TUDO! üí•<br>
          <span style="font-size: 2rem; color: #ffff00;">GAME OVER √âPICO!</span>
        </div>
      `;
      gameOverText.classList.add('textReveal');
      document.body.appendChild(gameOverText);
      
      // Remove texto ap√≥s 3 segundos
      setTimeout(() => {
        gameOverText.remove();
        // Remove todas as part√≠culas
        particles.forEach(p => p.remove());
        // Reset visual
        document.body.classList.remove('megaShake', 'screenFlash');
        chapolin.style.display = 'none';
        chapolin.classList.remove('chapolinExplode');
        btn1.style.display = 'none';
        
        // Alert final √©pico
        alert("üé¨ EXPLOS√ÉO √âPICA CONCLU√çDA! üé¨\n\nChapolin ganhou o Oscar de melhor explos√£o!\n\nRecarregando para nova tentativa...");
        location.reload();
      }, 3000);
      
    }, 1500);
    
  }, 800);
}

// Rastreia a posi√ß√£o do mouse
gameContainer.addEventListener('mousemove', (e) => {
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
});

// Hover no bot√£o
btn1.addEventListener('mouseenter', ()=>{
  startGame(); // Inicia o jogo no primeiro hover
  hoverCount++;
  attemptsEl.textContent = hoverCount;
  
  updateButtonColor();
  updateButtonSize();
  updateDifficulty();
  updateVolume();

  if(hoverCount >=5 && hoverCount <30){
    chapolinTap();
  }

  if(hoverCount >=30){
    explodeButton();
  } else {
    // Aumenta a velocidade de fuga conforme a dificuldade
    const escapeSpeed = Math.min(50 + (hoverCount * 5), 200); // Mais r√°pido!
    
    setTimeout(() => {
      // 30% de chance de movimento aleat√≥rio, 70% de fuga inteligente
      let pos;
      if (Math.random() < 0.3) {
        pos = getRandomPosition(); // Movimento aleat√≥rio
      } else {
        pos = getPositionAwayFromCursor(); // Foge do cursor
      }
      
      // Velocidade de transi√ß√£o baseada na dificuldade
      const transitionSpeed = Math.max(0.1, 0.5 - hoverCount * 0.015);
      btn1.style.transition = `all ${transitionSpeed}s ease`;
      btn1.style.left = pos.x + "px";
      btn1.style.top = pos.y + "px";
    }, escapeSpeed);
  }
});

// Clique no bot√£o
btn1.addEventListener('click', ()=>{
  if(hoverCount < 30){
    finalAttempts.textContent = hoverCount;
    document.getElementById('stage1').classList.remove('active');
    document.getElementById('winScreen').classList.add('active');
    
    // Vit√≥ria musical!
    bgMusic.volume = 0.3;
    bgMusic.playbackRate = 0.8;
  }
});

// Play again
document.getElementById('playAgain').onclick = ()=>location.reload();

// Inicia a m√∫sica ao clicar em qualquer lugar da p√°gina (para desbloquear autoplay)
document.addEventListener('click', startGame);

// Tenta iniciar a m√∫sica automaticamente ap√≥s um pequeno delay
setTimeout(() => {
    if (!gameStarted) {
        startGame();
    }
}, 500);

// Adiciona evento para quando a m√∫sica para
bgMusic.addEventListener('ended', () => {
    if (gameStarted) {
        bgMusic.currentTime = 0;
        bgMusic.play().catch(e => console.log('Erro ao reiniciar m√∫sica:', e));
    }
});

// Adiciona evento para quando a m√∫sica √© pausada
bgMusic.addEventListener('pause', () => {
    if (gameStarted) {
        setTimeout(() => {
            if (bgMusic.paused) {
                bgMusic.play().catch(e => console.log('Erro ao retomar m√∫sica pausada:', e));
            }
        }, 100);
    }
});
</script>
</body>
</html>
